<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#050a14">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>HeartGuard</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=45">
    <link rel="stylesheet" href="{{ url_for('static', filename='theme.css') }}?v=45">
</head>

<body>
    <div class="app-background-3d"></div>

    <!-- 3D Intro / Login Overlay -->
    <div class="intro-overlay" id="introOverlay">
        <div class="intro-card">
            <div class="intro-logo"><i class="fa-solid fa-heart-pulse"></i></div>
            <h1 class="intro-title">HeartGuard</h1>
            <p class="intro-subtitle">Professional Cardiac Analysis System</p>

            <form class="intro-login-form" onsubmit="handleLandingLogin(event)">
                <div class="input-group-3d">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" id="landingUser" placeholder="Access Username" required>
                </div>
                <div class="input-group-3d">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password" id="landingPass" placeholder="Security Password" required>
                </div>
                <button type="submit" class="btn-intro">Authorize Access</button>
            </form>

            <div class="guest-access">
                <a href="#" onclick="enterAppAsGuest()">Enter as Visitor <i class="fa-solid fa-arrow-right"></i></a>
            </div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- Mobile Header with Hamburger -->
    <div class="mobile-header">
        <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fa-solid fa-bars"></i>
        </button>
        <div class="brand-mobile">
            <div class="logo-icon-sm"><i class="fa-solid fa-heart-pulse"></i></div>
            <span>HeartGuard</span>
        </div>
    </div>

    <div class="app-container">
        <!-- Sidebar Navigation (Reference Design) -->
        <nav class="sidebar" id="sidebar">
            <button class="close-sidebar" onclick="toggleSidebar()"><i class="fa-solid fa-xmark"></i></button>
            <div class="brand">
                <div class="logo-icon"><i class="fa-solid fa-heart-pulse"></i></div>
                <span>HeartGuard</span>
            </div>

            <ul class="nav-links">
                <li class="active" onclick="switchTab(event, 'home')">
                    <i class="fa-solid fa-house"></i>
                    <span>Home</span>
                </li>
                <li onclick="switchTab(event, 'assessment')">
                    <i class="fa-solid fa-stethoscope"></i>
                    <span>Checkup</span>
                </li>
                <li onclick="switchTab(event, 'history')">
                    <i class="fa-solid fa-clock-rotate-left"></i>
                    <span>History</span>
                </li>
                <li onclick="switchTab(event, 'about')">
                    <i class="fa-solid fa-circle-info"></i>
                    <span>About</span>
                </li>
            </ul>

            <div class="user-profile" id="userProfile">
                <div class="login-card-ref">
                    <p class="login-text-ref">MEMBER LOGIN</p>
                    <button class="login-btn-ref" onclick="openLoginModal()">
                        <i class="fa-solid fa-user"></i> Sign In
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Header (Desktop Only) -->
            <header class="top-bar desktop-only">
                <div class="user-welcome">
                    <h1 id="welcomeUser">Hello, Guest!</h1>
                    <p>Track your heart health today.</p>
                </div>
                <div class="header-actions">
                    <button class="icon-btn notification-btn"><i class="fa-regular fa-bell"></i></button>
                    <div class="date-display" id="currentDate"></div>
                </div>
            </header>

            <!-- Home Dashboard View (Default) -->
            <div id="home" class="view-section active">
                <!-- Hero Banner -->
                <div class="hero-banner">
                    <div class="hero-content">
                        <h2>Check Your<br>Heart Risk</h2>
                        <p>AI-powered assessment in minutes.</p>
                        <button class="btn btn-light" onclick="switchTab(null, 'assessment')">Start Now <i
                                class="fa-solid fa-arrow-right"></i></button>
                    </div>
                    <div class="hero-image">
                        <i class="fa-solid fa-user-doctor"></i>
                    </div>
                </div>

                <!-- Feature Grid -->
                <h3 class="section-title">Quick Actions</h3>
                <div class="feature-grid-home">
                    <div class="feature-item" onclick="switchTab(null, 'assessment')">
                        <div class="feature-icon bg-blue"><i class="fa-solid fa-stethoscope"></i></div>
                        <span>Clinical Checkup</span>
                    </div>
                    <div class="feature-item" onclick="switchTab(null, 'history')">
                        <div class="feature-icon bg-green"><i class="fa-solid fa-clock-rotate-left"></i></div>
                        <span>History Records</span>
                    </div>
                    <div class="feature-item" onclick="openLoginModal()">
                        <div class="feature-icon bg-purple"><i class="fa-solid fa-user-lock"></i></div>
                        <span>Secure Auth</span>
                    </div>
                    <div class="feature-item" onclick="switchTab(null, 'about')">
                        <div class="feature-icon bg-orange"><i class="fa-solid fa-circle-info"></i></div>
                        <span>About System</span>
                    </div>
                </div>

                <!-- Live Stats Bar (Aesthetic) -->
                <div class="stats-bar-premium">
                    <div class="stat-pill">
                        <span class="stat-val">98.2%</span>
                        <span class="stat-lab">Model Accuracy</span>
                    </div>
                    <div class="stat-pill">
                        <span class="stat-val">5,000+</span>
                        <span class="stat-lab">Processed Cases</span>
                    </div>
                    <div class="stat-pill">
                        <span class="stat-val">Real-time</span>
                        <span class="stat-lab">AI Diagnostics</span>
                    </div>
                </div>

                <!-- Recent Activity / Doctor Promo -->
                <h3 class="section-title">Medical Assistant</h3>
                <div class="doctor-card">
                    <img src="https://img.freepik.com/free-photo/woman-doctor-wearing-lab-coat-with-stethoscope-isolated_1303-29791.jpg"
                        alt="Dr. AI" class="doc-img">
                    <div class="doc-info">
                        <h4>Dr. HeartGuard AI</h4>
                        <p>Virtual Assistant</p>
                    </div>
                    <button class="btn-icon-small"><i class="fa-solid fa-comment-medical"></i></button>
                </div>
            </div>

            <!-- Assessment View -->
            <div id="assessment" class="view-section">
                <div class="assessment-container">
                    <!-- Progress Stepper -->
                    <div class="stepper">
                        <div class="step active" data-step="1">
                            <div class="step-circle">1</div>
                            <div class="step-label">Personal</div>
                        </div>
                        <div class="step-line"></div>
                        <div class="step" data-step="2">
                            <div class="step-circle">2</div>
                            <div class="step-label">Vitals</div>
                        </div>
                        <div class="step-line"></div>
                        <div class="step" data-step="3">
                            <div class="step-circle">3</div>
                            <div class="step-label">Clinical</div>
                        </div>
                    </div>

                    <!-- Multi-step Form -->
                    <form id="assessmentForm" onsubmit="return false;">

                        <!-- Step 1: Personal Info -->
                        <div class="form-step active" id="step1">
                            <h3>Personal Information</h3>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Age (years)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-cake-candles"></i>
                                        <input type="number" id="age" min="1" max="120" placeholder="e.g. 45" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Sex</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-venus-mars"></i>
                                        <select id="sex" required>
                                            <option value="">Select Gender</option>
                                            <option value="1">Male</option>
                                            <option value="0">Female</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-actions">
                                <div></div> <!-- Spacer -->
                                <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next: Vitals <i
                                        class="fa-solid fa-arrow-right"></i></button>
                            </div>
                        </div>

                        <!-- Step 2: Vitals -->
                        <div class="form-step" id="step2">
                            <h3>Vital Signs</h3>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Resting Blood Pressure (mmHg)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-droplet"></i>
                                        <input type="number" id="resting_blood_pressure" min="50" max="250"
                                            placeholder="e.g. 120" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Cholesterol (mg/dl)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-burger"></i>
                                        <input type="number" id="cholesterol" min="100" max="600" placeholder="e.g. 200"
                                            required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Max Heart Rate (bpm)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-heart-pulse"></i>
                                        <input type="number" id="max_heart_rate" min="40" max="220"
                                            placeholder="e.g. 150" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Fasting Blood Sugar > 120 mg/dl</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-cube"></i>
                                        <select id="fasting_blood_sugar" required>
                                            <option value="0">No</option>
                                            <option value="1">Yes</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="prevStep(1)"><i
                                        class="fa-solid fa-arrow-left"></i> Back</button>
                                <button type="button" class="btn btn-primary" onclick="nextStep(3)">Next: Clinical <i
                                        class="fa-solid fa-arrow-right"></i></button>
                            </div>
                        </div>

                        <!-- Step 3: Clinical -->
                        <div class="form-step" id="step3">
                            <h3>Clinical Measurements</h3>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label>Chest Pain Type</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-lungs"></i>
                                        <select id="chest_pain_type" required>
                                            <option value="">Select Type</option>
                                            <option value="0">Typical Angina</option>
                                            <option value="1">Atypical Angina</option>
                                            <option value="2">Non-anginal Pain</option>
                                            <option value="3">Asymptomatic</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Resting ECG Results</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-wave-square"></i>
                                        <select id="resting_ecg" required>
                                            <option value="0">Normal</option>
                                            <option value="1">ST-T Wave Abnormality</option>
                                            <option value="2">Left Ventricular Hypertrophy</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Exercise Induced Angina</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-person-running"></i>
                                        <select id="exercise_induced_angina" required>
                                            <option value="0">No</option>
                                            <option value="1">Yes</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>ST Depression (Oldpeak)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-arrow-trend-down"></i>
                                        <input type="number" id="st_depression" step="0.1" min="0" max="10"
                                            placeholder="e.g. 1.0" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Slope of Peak Exercise ST</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-chart-line"></i>
                                        <select id="st_slope" required>
                                            <option value="0">Upsloping</option>
                                            <option value="1">Flat</option>
                                            <option value="2">Downsloping</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Number of Major Vessels (0-3)</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-network-wired"></i>
                                        <select id="major_vessels" required>
                                            <option value="0">0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group span-2">
                                    <label>Thalassemia</label>
                                    <div class="input-wrapper">
                                        <i class="fa-solid fa-dna"></i>
                                        <select id="thalassemia" required>
                                            <option value="0">Normal</option>
                                            <option value="1">Fixed Defect</option>
                                            <option value="2">Reversible Defect</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="prevStep(2)"><i
                                        class="fa-solid fa-arrow-left"></i> Back</button>
                                <button type="button" class="btn btn-submit" onclick="submitAssessment()">Analyze Risk
                                    <i class="fa-solid fa-bolt"></i></button>
                            </div>
                        </div>
                    </form>

                    <!-- Results Dashboard (Hidden Initially) -->
                    <div id="resultsDashboard" class="results-dashboard hidden">
                        <div class="results-header">
                            <button class="btn btn-text" onclick="resetAssessment()"><i
                                    class="fa-solid fa-arrow-left"></i> New Assessment</button>
                            <h2>Assessment Results</h2>
                        </div>

                        <div class="dashboard-grid">
                            <!-- Risk Gauge Card -->
                            <div class="dashboard-card risk-card">
                                <h3>Risk Probability</h3>
                                <div class="gauge-container">
                                    <svg class="progress-ring" width="160" height="160">
                                        <circle class="progress-ring__circle-bg" stroke="#e2e8f0" stroke-width="12"
                                            fill="transparent" r="70" cx="80" cy="80" />
                                        <circle class="progress-ring__circle" stroke="var(--primary)" stroke-width="12"
                                            fill="transparent" r="70" cx="80" cy="80" />
                                    </svg>
                                    <div class="gauge-value">
                                        <span id="riskPercentage">0%</span>
                                        <span class="gauge-label">Risk</span>
                                    </div>
                                </div>
                                <div id="riskLevelText" class="risk-badge">Low Risk</div>
                                <p id="riskMessage" class="risk-desc">Your results indicate a low probability of heart
                                    disease.</p>
                            </div>

                            <!-- Key Metrics Card -->
                            <div class="dashboard-card metrics-card">
                                <h3>Key Metrics</h3>
                                <div class="metric-item">
                                    <span class="metric-label">Blood Pressure</span>
                                    <span class="metric-value" id="resBP">--</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Cholesterol</span>
                                    <span class="metric-value" id="resChol">--</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Heart Rate</span>
                                    <span class="metric-value" id="resHR">--</span>
                                </div>
                            </div>

                            <!-- Precautions Card -->
                            <div class="dashboard-card precautions-card span-2">
                                <h3>Medical Precautions</h3>
                                <ul id="precautionsList" class="check-list">
                                    <!-- Populated by JS -->
                                </ul>
                            </div>

                            <!-- Diet Plan Card -->
                            <div class="dashboard-card diet-card span-2">
                                <h3>Recommended Diet Plan</h3>
                                <div class="diet-grid">
                                    <div class="diet-column">
                                        <h4 class="text-success"><i class="fa-solid fa-check"></i> Recommended Foods
                                        </h4>
                                        <ul id="dietEatList" class="diet-list"></ul>
                                    </div>
                                    <div class="diet-column">
                                        <h4 class="text-danger"><i class="fa-solid fa-xmark"></i> Foods to Avoid</h4>
                                        <ul id="dietAvoidList" class="diet-list"></ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Medical Disclaimer -->
                        <div class="medical-disclaimer">
                            <i class="fa-solid fa-triangle-exclamation"></i>
                            <div class="disclaimer-content">
                                <strong>Medical Disclaimer:</strong>
                                <p>This assessment is powered by AI and is for informational purposes only. It does not
                                    constitute medical advice, diagnosis, or treatment. Results may vary and should not
                                    be used as the sole basis for healthcare decisions. Always consult with a qualified
                                    healthcare professional regarding any medical concerns.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Overlay -->
                    <div id="loadingOverlay" class="loading-overlay hidden">
                        <div class="spinner"></div>
                        <p>Analyzing medical data...</p>
                    </div>

                </div>
            </div>

            <!-- History View -->
            <div id="history" class="view-section">
                <div class="section-header">
                    <h2>Assessment History</h2>
                    <div class="history-controls">
                        <div class="date-filter">
                            <i class="fa-solid fa-calendar-day"></i>
                            <input type="date" id="historyDateFilter" onchange="filterHistory()">
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="loadHistory()">Refresh</button>
                        <button class="btn btn-danger btn-sm" onclick="clearHistory()">Clear All</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table" id="historyTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Age</th>
                                <th>BP</th>
                                <th>Cholesterol</th>
                                <th>Risk Level</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="historyBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- About View -->
            <div id="about" class="view-section">
                <div class="about-container">
                    <div class="about-hero">
                        <h2>Advanced Cardiac Diagnostics</h2>
                        <p>Powered by HeartGuard AIâ„¢ Engine v2.0</p>
                    </div>
                    <div class="grid-3">
                        <div class="feature-card">
                            <i class="fa-solid fa-brain"></i>
                            <h3>Ensemble Learning</h3>
                            <p>Correlates data through 6 clinical models including KNN, SVM, and Neural Networks for
                                maximum precision.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fa-solid fa-shield-heart"></i>
                            <h3>Privacy First</h3>
                            <p>Military-grade encryption for all patient data. Localized processing ensures absolute
                                confidentiality.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fa-solid fa-user-doctor"></i>
                            <h3>Cardiologist Validated</h3>
                            <p>Development supervised by professional clinical consultants using global WHO standards.
                            </p>
                        </div>
                    </div>

                    <div class="certified-badges">
                        <div class="badge-item"><i class="fa-solid fa-check-circle"></i> ISO/IEC 27001</div>
                        <div class="badge-item"><i class="fa-solid fa-check-circle"></i> HIPPA Compliant</div>
                        <div class="badge-item"><i class="fa-solid fa-check-circle"></i> Secure ML Engine</div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Result Details Modal -->
    <div id="historyDetailsModal" class="modal">
        <div class="modal-content history-details-ref">
            <span class="close-modal" onclick="closeHistoryDetails()">&times;</span>
            <div class="details-header">
                <div class="details-icon"><i class="fa-solid fa-file-medical"></i></div>
                <h2 id="detailsTitle">Assessment Result</h2>
                <div id="detailsDate" class="details-date-text"></div>
            </div>

            <div class="details-body">
                <div class="details-risk-section">
                    <div id="detailsRiskBadge" class="risk-badge"></div>
                    <div id="detailsRiskPercent" class="risk-percentage-mini"></div>
                </div>

                <div class="details-grid">
                    <div class="detail-item">
                        <span class="label">Age</span>
                        <span id="detAge" class="val">--</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Blood Pressure</span>
                        <span id="detBP" class="val">--</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Cholesterol</span>
                        <span id="detChol" class="val">--</span>
                    </div>
                    <div class="detail-item">
                        <span class="label">Max Heart Rate</span>
                        <span id="detHR" class="val">--</span>
                    </div>
                </div>

                <div class="details-message" id="detailsMsg"></div>

                <!-- Complete prediction details -->
                <div class="details-advice-container">
                    <h3 class="section-title-mini">Recommended Precautions</h3>
                    <ul id="detPrecautionsList" class="check-list-mini">
                        <!-- Populated by JS -->
                    </ul>

                    <h3 class="section-title-mini">Dietary Guidance</h3>
                    <div class="diet-grid-mini">
                        <div class="diet-col">
                            <h4 class="text-success">Authorized Foods</h4>
                            <ul id="detDietEatList" class="diet-list-mini"></ul>
                        </div>
                        <div class="diet-col">
                            <h4 class="text-danger">Restricted Foods</h4>
                            <ul id="detDietAvoidList" class="diet-list-mini"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary full-width" onclick="closeHistoryDetails()">Close</button>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content login-modal-unique">
            <span class="close-modal" onclick="closeLoginModal()">&times;</span>
            <div class="login-header">
                <div class="login-icon-large">
                    <i class="fa-solid fa-fingerprint"></i>
                </div>
                <h2>Secure Access</h2>
                <p>Enter your credentials to continue</p>
            </div>
            <form id="loginForm" onsubmit="handleLogin(event)" class="login-form-styled">
                <div class="form-group-floating">
                    <input type="text" id="loginUser" required placeholder=" ">
                    <label>Username</label>
                    <i class="fa-solid fa-user icon"></i>
                </div>
                <div class="form-group-floating">
                    <input type="password" id="loginPass" required placeholder=" ">
                    <label>Password</label>
                    <i class="fa-solid fa-lock icon"></i>
                </div>
                <button type="submit" class="btn btn-primary full-width btn-login-submit">
                    Sign In <i class="fa-solid fa-arrow-right"></i>
                </button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}?v=45"></script>
</body>

</html>